"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[540],{9540:function(e,n,t){t.r(n),t.d(n,{default:function(){return _}});var a=t(2791),r=t(4942),s=t(1413),c=t(4165),i=t(5861),l=t(9439),o=t(1243),d=t(7689),u=t(9743),h=t(2677),p=t(5943),m=t(5630),f=t(3360),x=t(9806),Z=t(6850),j=t(8451),v=t(814),g=t(184),N=function(){var e=(0,d.s0)(),n=(0,a.useContext)(j.y),t=(0,a.useContext)(v.A),N=(0,a.useState)(),w=(0,l.Z)(N,2),y=w[0],C=w[1],_=(0,a.useState)(!1),b=(0,l.Z)(_,2),S=b[0],k=b[1],P=JSON.parse(localStorage.getItem("cart"));if(void 0===P.address){P.address={add:"",province_id:null,district_id:null,ward_id:null}}var V=(0,a.useState)([]),E=(0,l.Z)(V,2),I=E[0],T=E[1],q=(0,a.useState)(P.address.province_id),A=(0,l.Z)(q,2),O=A[0],Y=A[1],D=(0,a.useState)([]),H=(0,l.Z)(D,2),L=H[0],G=H[1],B=(0,a.useState)(P.address.district_id),F=(0,l.Z)(B,2),M=F[0],R=F[1],z=(0,a.useState)([]),J=(0,l.Z)(z,2),K=J[0],Q=J[1],U=(0,a.useState)(P.address.ward_id),W=(0,l.Z)(U,2),X=W[0],$=W[1],ee=(0,a.useState)(P.address.add),ne=(0,l.Z)(ee,2),te=ne[0],ae=ne[1],re=(0,a.useState)("VNPAY"),se=(0,l.Z)(re,2),ce=se[0],ie=se[1],le=(0,a.useState)({firstName:"",lastName:"",phoneNumber:"",email:""}),oe=(0,l.Z)(le,2),de=oe[0],ue=oe[1],he=(0,a.useState)({firstName:"",lastName:"",phoneNumber:""}),pe=(0,l.Z)(he,2),me=pe[0],fe=pe[1];(0,a.useEffect)((function(){var e=function(){var e=(0,i.Z)((0,c.Z)().mark((function e(){return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.Z.get("".concat("http://localhost:5000","/user/profile/my-profile"),{withCredentials:!0}).then((function(e){ue({firstName:e.data.firstName,lastName:e.data.lastName,phoneNumber:e.data.phoneNumber,email:e.data.email}),fe({firstName:e.data.firstName,lastName:e.data.lastName,phoneNumber:e.data.phoneNumber,email:e.data.email})})).catch((function(e){return console.log(e)}));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[]),(0,a.useEffect)((function(){var e=function(){var e=(0,i.Z)((0,c.Z)().mark((function e(){return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.Z.get("https://provinces.open-api.vn/api/p/").then((function(e){return T(e.data)})).catch((function(e){return console.log(e)}));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[]),(0,a.useEffect)((function(){var e=function(){var e=(0,i.Z)((0,c.Z)().mark((function e(){return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.Z.get("https://provinces.open-api.vn/api/p/".concat(O,"?depth=2")).then((function(e){return G(e.data.districts)})).catch((function(e){return console.log(e)}));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[O]),(0,a.useEffect)((function(){var e=function(){var e=(0,i.Z)((0,c.Z)().mark((function e(){return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.Z.get("https://provinces.open-api.vn/api/d/".concat(M,"?depth=2")).then((function(e){return Q(e.data.wards)})).catch((function(e){return console.log(e)}));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[M]);var xe=function(e){ie(e.target.value)};0===n.selectedItems.length&&(window.alert("Vui l\xf2ng ch\u1ecdn s\u1ea3n ph\u1ea9m tr\u01b0\u1edbc khi \u0111\u1eb7t h\xe0ng"),e("/gio-hang"));(0,a.useEffect)((function(){if(void 0!==y)if("VNPAY"===y.paymentMethod&&!1===y.paymentStatus.isPaid){var n=function(){var n=(0,i.Z)((0,c.Z)().mark((function n(){return(0,c.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,o.Z.post("".concat("http://localhost:5000","/order/create-vnpay-url/").concat(y._id)).then((function(n){e("/chi-tiet-don-hang/".concat(y._id)),window.open(n.data)})).catch((function(e){return console.log(e)}));case 2:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}();n()}else e("/chi-tiet-don-hang/".concat(y._id))}),[y,e]);var Ze=function(){k(!1),fe(de)},je=function(){var n=(0,i.Z)((0,c.Z)().mark((function n(t){return(0,c.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t.preventDefault(),n.next=3,o.Z.put("".concat("http://localhost:5000","/user/profile/update"),me,{withCredentials:!0}).then((function(n){e(0)})).catch((function(e){console.log(e)}));case 3:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}();return(0,g.jsxs)("div",{className:"customer-info",children:[(0,g.jsxs)(u.Z,{children:[(0,g.jsx)(h.Z,{children:(0,g.jsx)("p",{className:"form-title",children:"Th\xf4ng tin kh\xe1ch h\xe0ng:"})}),(0,g.jsx)(h.Z,{className:"custom-col",children:(0,g.jsxs)("button",{className:"change-info__btn",onClick:function(){k(!0)},children:[(0,g.jsx)(x.G,{icon:Z.Yai}),(0,g.jsx)("span",{children:"Thay \u0111\u1ed5i"})]})})]}),(0,g.jsxs)(u.Z,{children:[(0,g.jsx)(h.Z,{lg:3,children:(0,g.jsx)("span",{children:"Ng\u01b0\u1eddi nh\u1eadn:"})}),(0,g.jsx)(h.Z,{lg:9,children:(0,g.jsxs)("span",{className:"isbold",children:[de.lastName," ",de.firstName]})})]}),(0,g.jsxs)(u.Z,{children:[(0,g.jsx)(h.Z,{lg:3,children:(0,g.jsx)("span",{children:"Email:"})}),(0,g.jsx)(h.Z,{lg:9,children:(0,g.jsx)("span",{children:de.email})})]}),(0,g.jsxs)(u.Z,{children:[(0,g.jsx)(h.Z,{lg:3,children:(0,g.jsx)("span",{children:"S\u1ed1 \u0111i\u1ec7n tho\u1ea1i:"})}),(0,g.jsx)(h.Z,{lg:9,children:(0,g.jsx)("span",{children:de.phoneNumber})})]}),(0,g.jsxs)(p.Z,{dialogClassName:"modal-custom",show:S,onHide:Ze,children:[(0,g.jsx)(p.Z.Header,{closeButton:!0,children:(0,g.jsx)(p.Z.Title,{children:"C\u1eadp nh\u1eadt th\xf4ng tin"})}),(0,g.jsxs)(m.Z,{onSubmit:je,children:[(0,g.jsxs)(p.Z.Body,{children:[(0,g.jsxs)(u.Z,{className:"custom-row",children:[(0,g.jsx)(h.Z,{lg:3,children:(0,g.jsx)("span",{children:"Email:"})}),(0,g.jsx)(h.Z,{children:(0,g.jsx)("span",{children:de.email})})]}),(0,g.jsxs)(u.Z,{className:"custom-row",children:[(0,g.jsx)(m.Z.Label,{column:!0,lg:3,children:"H\u1ecd:"}),(0,g.jsx)(h.Z,{children:(0,g.jsx)(m.Z.Control,{onChange:function(e){fe((0,s.Z)((0,s.Z)({},me),{},(0,r.Z)({},e.target.name,e.target.value)))},name:"lastName",type:"text",defaultValue:de.lastName})})]}),(0,g.jsxs)(u.Z,{className:"custom-row",children:[(0,g.jsx)(m.Z.Label,{column:!0,lg:3,children:"T\xean:"}),(0,g.jsx)(h.Z,{children:(0,g.jsx)(m.Z.Control,{onChange:function(e){fe((0,s.Z)((0,s.Z)({},me),{},(0,r.Z)({},e.target.name,e.target.value)))},name:"firstName",type:"text",defaultValue:de.firstName})})]}),(0,g.jsxs)(u.Z,{className:"custom-row",children:[(0,g.jsx)(m.Z.Label,{column:!0,lg:3,children:"\u0110i\u1ec7n tho\u1ea1i:"}),(0,g.jsx)(h.Z,{children:(0,g.jsx)(m.Z.Control,{onChange:function(e){fe((0,s.Z)((0,s.Z)({},me),{},(0,r.Z)({},e.target.name,e.target.value)))},name:"phoneNumber",type:"text",pattern:"[0-9]*",defaultValue:de.phoneNumber})})]})]}),(0,g.jsxs)(p.Z.Footer,{children:[(0,g.jsx)(f.Z,{variant:"danger",onClick:Ze,children:"H\u1ee7y"}),(0,g.jsx)(f.Z,{variant:"primary",type:"submit",children:"C\u1eadp nh\u1eadt"})]})]})]}),(0,g.jsxs)(m.Z,{children:[(0,g.jsxs)("div",{children:[(0,g.jsx)("p",{className:"form-title",children:"\u0110\u1ecba ch\u1ec9 nh\u1eadn h\xe0ng:"}),(0,g.jsxs)(u.Z,{className:"form-row",children:[(0,g.jsx)(h.Z,{children:(0,g.jsxs)(m.Z.Select,{onChange:function(e){Y(e.target.value)},value:null!==O?O:0,children:[(0,g.jsx)("option",{value:0,children:"Ch\u1ecdn t\u1ec9nh/th\xe0nh ph\u1ed1"}),I.map((function(e){return(0,g.jsx)("option",{value:e.code,children:e.name},e.code)}))]})}),(0,g.jsx)(h.Z,{children:(0,g.jsxs)(m.Z.Select,{onChange:function(e){R(e.target.value)},value:null!==M?M:0,children:[(0,g.jsx)("option",{value:0,children:"Ch\u1ecdn qu\u1eadn/huy\u1ec7n"}),L.map((function(e){return(0,g.jsx)("option",{value:e.code,children:e.name},e.code)}))]})}),(0,g.jsx)(h.Z,{children:(0,g.jsxs)(m.Z.Select,{onChange:function(e){$(e.target.value)},value:null!==X?X:0,children:[(0,g.jsx)("option",{value:0,children:"Ch\u1ecdn ph\u01b0\u1eddng/x\xe3"}),K.map((function(e){return(0,g.jsx)("option",{value:e.code,children:e.name},e.code)}))]})})]}),(0,g.jsx)(u.Z,{className:"form-row",children:(0,g.jsxs)(m.Z.Group,{className:"custom-form__input",children:[(0,g.jsx)(m.Z.Label,{children:"\u0110\u1ecba ch\u1ec9"}),(0,g.jsx)(m.Z.Control,{defaultValue:te,onChange:function(e){ae(e.target.value)},type:"text",required:!0})]})})]}),(0,g.jsx)("p",{className:"form-title",children:"Ph\u01b0\u01a1ng th\u1ee9c thanh to\xe1n"}),(0,g.jsxs)(u.Z,{className:"form-row",children:[(0,g.jsx)(h.Z,{children:(0,g.jsx)(m.Z.Check,{value:"VNPAY",onChange:xe,checked:"VNPAY"===ce,id:"VNPAY",name:"payment-method",type:"radio",inline:!0,label:"Thanh to\xe1n qua VNPay"})}),(0,g.jsx)(h.Z,{children:(0,g.jsx)(m.Z.Check,{value:"COD",onChange:xe,checked:"COD"===ce,id:"COD",name:"payment-method",type:"radio",inline:!0,label:"Thanh to\xe1n khi nh\u1eadn h\xe0ng"})})]}),(0,g.jsx)("button",{onClick:function(e){if(e.preventDefault(),void 0===O||0===O||void 0===M||0===M||void 0===X||0===X||void 0===te||""===te)return window.alert("Vui l\xf2ng nh\u1eadp \u0111\u1ecba ch\u1ec9 \u0111\u1eb7t h\xe0ng!");var a=I.find((function(e){return e.code.toString()===O})),r=L.find((function(e){return e.code.toString()===M})),s=K.find((function(e){return e.code.toString()===X})),l=te+", "+s.name+", "+r.name+", "+a.name,d={province_id:O,district_id:M,ward_id:X,add:te};n.setAddress(d);var u=function(){var e=(0,i.Z)((0,c.Z)().mark((function e(){return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.Z.post("".concat("http://localhost:5000","/order/create-order"),{items:n.selectedItems,address:l,paymentMethod:ce,price:n.selectedItems.reduce((function(e,n){return e+n.price*n.qty}),0),shippingFee:12e3,totalPrice:n.selectedItems.reduce((function(e,n){return e+n.price*n.qty}),0)+12e3},{withCredentials:!0}).then((function(e){var a=t.items.filter((function(e){return n.selectedItems.every((function(n){return toString(n._id)!==toString(e.id)}))}));t.setCartItems(a),C(e.data)})).catch((function(e){return console.log(e)}));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();u()},className:"place-order-btn",children:"TI\u1ebeP THEO"})]})]})},w=t(2643),y=t(1087),C=function(e){return(0,g.jsx)("li",{className:"selected-item__container",children:(0,g.jsxs)("div",{className:"selected-item",children:[(0,g.jsx)("div",{className:"selected-item__img",children:(0,g.jsx)("img",{src:e.image,alt:"product"})}),(0,g.jsxs)("div",{className:"selected-item__info",children:[(0,g.jsxs)("div",{className:"selected-item__info-left",children:[(0,g.jsx)(y.OL,{to:"/chi-tiet-san-pham/".concat(e.id),children:e.name}),(0,g.jsxs)("div",{className:"selected-item__qty",children:[(0,g.jsx)("span",{children:"S\u1ed1 l\u01b0\u1ee3ng: "}),(0,g.jsx)("span",{children:e.qty})]})]}),(0,g.jsxs)("div",{className:"group-price",children:[(0,g.jsx)("span",{className:"sell-price",children:(0,w.T)(e.price)}),(0,g.jsx)("span",{className:"origin-price",children:(0,w.T)(e.sellPrice)})]})]})]})})},_=function(){var e=(0,a.useContext)(j.y);return console.log(e.selectedItems),(0,g.jsx)("div",{className:"shipping-page",children:(0,g.jsxs)("div",{className:"shipping-page__main",children:[(0,g.jsxs)("div",{className:"list-item",children:[(0,g.jsx)("h3",{children:"S\u1ea3n ph\u1ea9m:"}),e.selectedItems.map((function(e){return(0,g.jsx)(C,{id:e._id,name:e.name,qty:e.qty,price:e.price,sellPrice:e.sellPrice,image:e.image},e._id)}))]}),(0,g.jsx)("div",{className:"shipping-page__info",children:(0,g.jsx)(N,{})})]})})}},9743:function(e,n,t){var a=t(1413),r=t(5987),s=t(1694),c=t.n(s),i=t(2791),l=t(162),o=t(184),d=["bsPrefix","className","as"],u=i.forwardRef((function(e,n){var t=e.bsPrefix,s=e.className,i=e.as,u=void 0===i?"div":i,h=(0,r.Z)(e,d),p=(0,l.vE)(t,"row"),m=(0,l.pi)(),f=(0,l.zG)(),x="".concat(p,"-cols"),Z=[];return m.forEach((function(e){var n,t=h[e];delete h[e],n=null!=t&&"object"===typeof t?t.cols:t;var a=e!==f?"-".concat(e):"";null!=n&&Z.push("".concat(x).concat(a,"-").concat(n))})),(0,o.jsx)(u,(0,a.Z)((0,a.Z)({ref:n},h),{},{className:c().apply(void 0,[s,p].concat(Z))}))}));u.displayName="Row",n.Z=u}}]);
//# sourceMappingURL=540.c227e4f7.chunk.js.map